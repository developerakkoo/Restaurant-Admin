"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1634],{1634:(F,m,l)=>{l.r(m),l.d(m,{ChatPageModule:()=>y});var h=l(177),u=l(4341),i=l(4488),d=l(8986),g=l(467),e=l(4438),f=l(4796);function _(t,r){1&t&&(e.j41(0,"ion-text",7)(1,"h1"),e.EFF(2,"No chats "),e.k0s()())}function p(t,r){if(1&t){const o=e.RV6();e.j41(0,"ion-item",10),e.bIt("click",function(){const s=e.eBV(o).$implicit,a=e.XpG(2);return e.Njj(a.openChat(s))}),e.j41(1,"ion-avatar",11),e.nrm(2,"img",12),e.k0s(),e.j41(3,"ion-label"),e.EFF(4),e.j41(5,"p"),e.EFF(6),e.k0s()(),e.j41(7,"ion-badge",13),e.EFF(8),e.nI1(9,"date"),e.k0s()()}if(2&t){const o=r.$implicit;e.R7$(2),e.Y8G("src",o.image,e.B4B),e.R7$(2),e.SpI(" ",o.members[0].name," "),e.R7$(2),e.SpI(" ",o.lastMessage.message||"Image received"," "),e.R7$(2),e.SpI(" ",e.i5U(9,4,o.createdAt,"shortDate")," ")}}function C(t,r){if(1&t&&(e.j41(0,"ion-list",8),e.DNE(1,p,10,7,"ion-item",9),e.k0s()),2&t){const o=e.XpG();e.R7$(),e.Y8G("ngForOf",o.messages)}}function I(t,r){if(1&t&&(e.j41(0,"ion-label",25),e.EFF(1),e.k0s()),2&t){const o=e.XpG().$implicit;e.R7$(),e.SpI(" ",o.message," ")}}function v(t,r){1&t&&e.nrm(0,"img",26)}function b(t,r){if(1&t&&(e.j41(0,"ion-item",22),e.DNE(1,I,2,1,"ion-label",23)(2,v,1,0,"img",24),e.k0s()),2&t){const o=r.$implicit,n=e.XpG(2);e.Y8G("color",o.senderId==n.senderId?"medium":"light"),e.R7$(),e.Y8G("ngIf",0==o.isImage),e.R7$(),e.Y8G("ngIf",1==o.isImage)}}function M(t,r){if(1&t){const o=e.RV6();e.j41(0,"ion-col",14)(1,"ion-card",15)(2,"ion-card-header")(3,"ion-item")(4,"ion-avatar",11),e.nrm(5,"img",16),e.k0s(),e.j41(6,"ion-label"),e.EFF(7),e.k0s()()(),e.j41(8,"ion-card-content")(9,"ion-list"),e.DNE(10,b,3,3,"ion-item",17),e.k0s()(),e.j41(11,"div",18)(12,"ion-input",19),e.mxI("ngModelChange",function(s){e.eBV(o);const a=e.XpG();return e.DH7(a.message,s)||(a.message=s),e.Njj(s)}),e.k0s(),e.j41(13,"ion-button",20),e.bIt("click",function(){e.eBV(o);const s=e.XpG();return e.Njj(s.sendMessage())}),e.nrm(14,"ion-icon",21),e.k0s()()()()}if(2&t){const o=e.XpG();e.R7$(7),e.JRh(o.chatName||"..."),e.R7$(3),e.Y8G("ngForOf",o.chatMessages),e.R7$(2),e.R50("ngModel",o.message)}}const P=[{path:"",component:(()=>{var t;class r{constructor(n,s){this.auth=n,this.loadingController=s,this.messages=[],this.chatMessages=[],this.chatName="",this.message="",this.orderId="",this.senderId="666979f2983fa6cd5cf79d08",this.receiverId="",this.chatId=""}ngOnInit(){}ionViewDidEnter(){this.getAllChats()}ionViewDidLeave(){clearInterval(this.interval)}onSearchChange(n){}getAllChats(){var s,n=this;this.auth.getAllChats().subscribe({next:(s=(0,g.A)(function*(a){console.log(a),n.messages=a.data}),function(c){return s.apply(this,arguments)}),error:function(){var s=(0,g.A)(function*(a){console.log(a.error)});return function(c){return s.apply(this,arguments)}}()})}openChat(n){console.log(n),this.orderId=n.lastMessage.orderId,this.receiverId=n.members[0]._id,this.chatId=n._id,this.chatName=n.members[0].name,this.getMessagesByChatId(n._id)}getMessagesByChatId(n){var a,s=this;this.auth.getMessagesByChatId(n).subscribe({next:(a=(0,g.A)(function*(c){console.log(c),s.chatMessages=c.data}),function(j){return a.apply(this,arguments)}),error:function(){var a=(0,g.A)(function*(c){console.log(c.error)});return function(j){return a.apply(this,arguments)}}()})}sendMessage(){var s,n=this;this.auth.sendMessage(this.chatId,this.senderId,this.receiverId,this.orderId,this.message).subscribe({next:(s=(0,g.A)(function*(a){console.log(a),n.getMessagesByChatId(n.chatId)}),function(c){return s.apply(this,arguments)}),error:s=>{console.log(s.error)}})}}return(t=r).\u0275fac=function(n){return new(n||t)(e.rXU(f.u),e.rXU(i.Xi))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-chat"]],decls:17,vars:6,consts:[[3,"translucent"],[3,"fullscreen"],["size","4"],["placeholder","Search","inputmode","decimal","type","decimal","showCancelButton","always",3,"ionChange","debounce"],["color","primary","class","ion-text-center",4,"ngIf"],["style","height: 60vh; overflow: auto;",4,"ngIf"],["size","8",4,"ngIf"],["color","primary",1,"ion-text-center"],[2,"height","60vh","overflow","auto"],["detail","",3,"click",4,"ngFor","ngForOf"],["detail","",3,"click"],["slot","start"],[3,"src"],["color","light","mode","ios"],["size","8"],[1,"chat-card-container"],["crossorigin","anonymous","src","assets/icon/favicon.png"],["class","chat-bubble","lines","none",3,"color",4,"ngFor","ngForOf"],[1,"card-footer"],["fill","outline","type","text","placeholder","Start a new message",3,"ngModelChange","ngModel"],["fill","clear",3,"click"],["slot","icon-only","name","send"],["lines","none",1,"chat-bubble",3,"color"],["style","float: right;",4,"ngIf"],["src","assets/icon/favicon.png","alt","","srcset","",4,"ngIf"],[2,"float","right"],["src","assets/icon/favicon.png","alt","","srcset",""]],template:function(n,s){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Chat"),e.k0s()()(),e.j41(4,"ion-content",1)(5,"ion-grid")(6,"ion-row")(7,"ion-col",2)(8,"ion-card")(9,"ion-card-header")(10,"ion-card-title"),e.EFF(11,"Messages"),e.k0s(),e.j41(12,"ion-searchbar",3),e.bIt("ionChange",function(c){return s.onSearchChange(c)}),e.k0s()(),e.j41(13,"ion-card-content"),e.DNE(14,_,3,0,"ion-text",4)(15,C,2,1,"ion-list",5),e.k0s()()(),e.DNE(16,M,15,3,"ion-col",6),e.k0s()()()),2&n&&(e.Y8G("translucent",!0),e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(8),e.Y8G("debounce",250),e.R7$(2),e.Y8G("ngIf",0==s.messages.length),e.R7$(),e.Y8G("ngIf",s.messages.length>0),e.R7$(),e.Y8G("ngIf",s.messages.length>0))},dependencies:[h.Sq,h.bT,u.BC,u.vS,i.mC,i.In,i.Jm,i.b_,i.I9,i.ME,i.tN,i.hU,i.W9,i.lO,i.eU,i.iq,i.$w,i.uz,i.he,i.nf,i.ln,i.S1,i.IO,i.BC,i.ai,i.Gw,h.vh],styles:[".chat-card-container[_ngcontent-%COMP%]{height:90vh}ion-item[_ngcontent-%COMP%]:hover{cursor:pointer}.card-footer[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;width:50rem;position:absolute;bottom:0;left:0}chat-bubble[_ngcontent-%COMP%]{width:50%;border-radius:50px}"]}),r})()}];let x=(()=>{var t;class r{}return(t=r).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[d.iI.forChild(P),d.iI]}),r})(),y=(()=>{var t;class r{}return(t=r).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[h.MD,u.YN,i.bv,x]}),r})()}}]);