"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1634],{1634:(y,d,l)=>{l.r(d),l.d(d,{ChatPageModule:()=>P});var g=l(177),u=l(4341),o=l(4488),m=l(8986),h=l(467),e=l(4438),f=l(4796);function _(t,r){1&t&&(e.j41(0,"ion-text",7)(1,"h1"),e.EFF(2,"No chats "),e.k0s()())}function p(t,r){if(1&t){const i=e.RV6();e.j41(0,"ion-item",10),e.bIt("click",function(){const a=e.eBV(i).$implicit,s=e.XpG(2);return e.Njj(s.openChat(a))}),e.j41(1,"ion-label"),e.EFF(2),e.j41(3,"p"),e.EFF(4),e.k0s()(),e.j41(5,"ion-badge",11),e.EFF(6),e.nI1(7,"date"),e.k0s()()}if(2&t){const i=r.$implicit;e.R7$(2),e.SpI(" ",i.user.phoneNumber," "),e.R7$(2),e.SpI(" ",i.lastMessage.text||"Image received"," "),e.R7$(2),e.SpI(" ",e.i5U(7,3,i.createdAt,"shortDate")," ")}}function C(t,r){if(1&t&&(e.j41(0,"ion-list",8),e.DNE(1,p,8,6,"ion-item",9),e.k0s()),2&t){const i=e.XpG();e.R7$(),e.Y8G("ngForOf",i.messages)}}function v(t,r){if(1&t&&(e.j41(0,"ion-item",21)(1,"ion-label",22),e.EFF(2),e.k0s()()),2&t){const i=r.$implicit;e.Y8G("color",i.lastMessage.isUser?"danger":"light"),e.R7$(2),e.SpI(" ",i.lastMessage.text," ")}}function I(t,r){if(1&t){const i=e.RV6();e.j41(0,"ion-col",12)(1,"ion-card",13)(2,"ion-card-header")(3,"ion-item")(4,"ion-avatar",14),e.nrm(5,"img",15),e.k0s(),e.j41(6,"ion-label"),e.EFF(7),e.k0s()()(),e.j41(8,"ion-card-content")(9,"ion-list"),e.DNE(10,v,3,2,"ion-item",16),e.k0s()(),e.j41(11,"div",17)(12,"ion-input",18),e.mxI("ngModelChange",function(a){e.eBV(i);const s=e.XpG();return e.DH7(s.message,a)||(s.message=a),e.Njj(a)}),e.k0s(),e.j41(13,"ion-button",19),e.bIt("click",function(){e.eBV(i);const a=e.XpG();return e.Njj(a.sendMessage())}),e.nrm(14,"ion-icon",20),e.k0s()()()()}if(2&t){const i=e.XpG();e.R7$(7),e.JRh(i.chatName||"..."),e.R7$(3),e.Y8G("ngForOf",i.chatMessages),e.R7$(2),e.R50("ngModel",i.message)}}const M=[{path:"",component:(()=>{var t;class r{constructor(n,a){this.auth=n,this.loadingController=a,this.messages=[],this.chatMessages=[],this.chatName="",this.message="",this.orderId="",this.senderId="666979f2983fa6cd5cf79d08",this.receiverId="",this.chatId=""}ngOnInit(){}ionViewDidEnter(){this.getAllChats()}ionViewDidLeave(){clearInterval(this.interval)}onSearchChange(n){}getAllChats(){var a,n=this;this.auth.getAllChats().subscribe({next:(a=(0,h.A)(function*(s){console.log(s),n.messages=s.data}),function(c){return a.apply(this,arguments)}),error:function(){var a=(0,h.A)(function*(s){console.log(s.error)});return function(c){return a.apply(this,arguments)}}()})}openChat(n){console.log(n),this.orderId=n.lastMessage.orderId,this.receiverId=n.user._id,this.chatId=n._id,this.chatName=n.user.phoneNumber,this.getMessagesByChatId(n._id)}getMessagesByChatId(n){var s,a=this;this.auth.getAllChats().subscribe({next:(s=(0,h.A)(function*(c){console.log(c),a.chatMessages=c.data}),function(x){return s.apply(this,arguments)}),error:function(){var s=(0,h.A)(function*(c){console.log(c.error)});return function(x){return s.apply(this,arguments)}}()})}sendMessage(){var a,n=this;this.auth.sendMessage(this.chatId,this.senderId,this.receiverId,this.orderId,this.message).subscribe({next:(a=(0,h.A)(function*(s){console.log(s),n.getMessagesByChatId(n.chatId)}),function(c){return a.apply(this,arguments)}),error:a=>{console.log(a.error)}})}}return(t=r).\u0275fac=function(n){return new(n||t)(e.rXU(f.u),e.rXU(o.Xi))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-chat"]],decls:17,vars:6,consts:[[3,"translucent"],[3,"fullscreen"],["size","4"],["placeholder","Search","inputmode","decimal","type","decimal","showCancelButton","always",3,"ionChange","debounce"],["color","primary","class","ion-text-center",4,"ngIf"],["style","height: 60vh; overflow: auto;",4,"ngIf"],["size","8",4,"ngIf"],["color","primary",1,"ion-text-center"],[2,"height","60vh","overflow","auto"],["detail","",3,"click",4,"ngFor","ngForOf"],["detail","",3,"click"],["color","light","mode","ios"],["size","8"],[1,"chat-card-container"],["slot","start"],["crossorigin","anonymous","src","assets/icon/favicon.png"],["class","chat-bubble","lines","none",3,"color",4,"ngFor","ngForOf"],[1,"card-footer"],["fill","outline","type","text","placeholder","Start a new message",3,"ngModelChange","ngModel"],["fill","clear",3,"click"],["slot","icon-only","name","send"],["lines","none",1,"chat-bubble",3,"color"],[2,"float","right"]],template:function(n,a){1&n&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Chat"),e.k0s()()(),e.j41(4,"ion-content",1)(5,"ion-grid")(6,"ion-row")(7,"ion-col",2)(8,"ion-card")(9,"ion-card-header")(10,"ion-card-title"),e.EFF(11,"Messages"),e.k0s(),e.j41(12,"ion-searchbar",3),e.bIt("ionChange",function(c){return a.onSearchChange(c)}),e.k0s()(),e.j41(13,"ion-card-content"),e.DNE(14,_,3,0,"ion-text",4)(15,C,2,1,"ion-list",5),e.k0s()()(),e.DNE(16,I,15,3,"ion-col",6),e.k0s()()()),2&n&&(e.Y8G("translucent",!0),e.R7$(4),e.Y8G("fullscreen",!0),e.R7$(8),e.Y8G("debounce",250),e.R7$(2),e.Y8G("ngIf",0==a.messages.length),e.R7$(),e.Y8G("ngIf",a.messages.length>0),e.R7$(),e.Y8G("ngIf",a.messages.length>0))},dependencies:[g.Sq,g.bT,u.BC,u.vS,o.mC,o.In,o.Jm,o.b_,o.I9,o.ME,o.tN,o.hU,o.W9,o.lO,o.eU,o.iq,o.$w,o.uz,o.he,o.nf,o.ln,o.S1,o.IO,o.BC,o.ai,o.Gw,g.vh],styles:[".chat-card-container[_ngcontent-%COMP%]{height:90vh}ion-item[_ngcontent-%COMP%]:hover{cursor:pointer}.card-footer[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;width:50rem;position:absolute;bottom:0;left:0}chat-bubble[_ngcontent-%COMP%]{width:50%;border-radius:50px}"]}),r})()}];let b=(()=>{var t;class r{}return(t=r).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[m.iI.forChild(M),m.iI]}),r})(),P=(()=>{var t;class r{}return(t=r).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[g.MD,u.YN,o.bv,b]}),r})()}}]);